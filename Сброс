&НаКлиенте
Процедура ЗавершитьРазговор(Команда)
	Попытка
		ФормаНабора = ПолучитьФорму("Обработка.бит_Битфон.Форма.ОсновнаяФорма");
		Если ФормаНабора.ИдетРазговор = Истина Тогда
			ФормаНабора.КнОтбой(Неопределено);
			Попытка
				ФормаНабора = ПолучитьФорму("Обработка.бит_Битфон.Форма.ОсновнаяФорма");
				Если ФормаНабора.ИдетРазговор = Ложь Тогда
					ФормаНабора.КнОтключить(Неопределено);
				КонецЕсли;
			Исключение
				ФормаНабора = ПолучитьФорму("Обработка.бит_Битфон.Форма.ОсновнаяФорма");
				Если ФормаНабора.ИдетРазговор = Ложь Тогда
					ФормаНабора.КнОтключить(Неопределено);
				КонецЕсли;
			КонецПопытки;
		КонецЕсли;
		Исключение
		Предупреждение("БИТ.Phone не подключен!");
	КонецПопытки
КонецПроцедуры

Для обработки оповещений:
	Если ИмяСобытия = "ЗвонокПрерван" Тогда 
		ФормаНабора = ПолучитьФорму("Обработка.бит_Битфон.Форма.ОсновнаяФорма");
		// Вывести длительность разговора
		ЭтаФорма.ДлительностьРазговора = ФормаНабора.ДлительностьРазговора;
		ЭтаФорма.Элементы.ДлительностьРазговора.Видимость = Истина;
		Если ФормаНабора.ИдетРазговор = Истина Тогда
			ФормаНабора.КнОтбой(Неопределено);
		КонецЕсли;
	КонецЕсли;
	
	Если ИмяСобытия = "РазговорЗавершен" Тогда 
		Попытка
			ФормаНабора = ПолучитьФорму("Обработка.бит_Битфон.Форма.ОсновнаяФорма");
			Если ФормаНабора.ИдетРазговор = Ложь Тогда
				ФормаНабора.КнОтключить(Неопределено);
			КонецЕсли;
		Исключение
			ФормаНабора = ПолучитьФорму("Обработка.бит_Битфон.Форма.ОсновнаяФорма");
			Если ФормаНабора.ИдетРазговор = Ложь Тогда
				ФормаНабора.КнОтключить(Неопределено);
			КонецЕсли;
		КонецПопытки;
	КонецЕсли;
