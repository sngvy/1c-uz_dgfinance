	
	// Попов
	
	///////////////////////////////////////////////// 
	// Список по дальним регионам (МСК+4...МСК+9) //
	///////////////////////////////////////////////
	
	СписокАвтообзвона = Справочники.СписокДляАвтообзвона.СоздатьЭлемент();
	СписокАвтообзвона.Наименование = "Дальние регионы " + Формат(ТекущаяДата(), "ДФ=dd.MM.yyyy");
	
	Запрос = Новый Запрос;
	// Используем ГСЧ для случайного порядка договоров
	ГСЧ = Новый ГенераторСлучайныхЧисел();
    СлучайноеЧисло = "%"+ГСЧ.СлучайноеЧисло(0, 10)+"%";
	Запрос.УстановитьПараметр("ГСЧ", СлучайноеЧисло);
	// Конец
	Запрос.Текст = 
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ДолговыеОбязательства.Ссылка КАК Ссылка,
	|	ДолговыеОбязательства.Кредитор КАК Кредитор,
	|	ДолговыеОбязательства.КодДО КАК КодДО
	|ИЗ
	|	Задача.Мероприятие КАК Мероприятие
	|		ПРАВОЕ СОЕДИНЕНИЕ Справочник.ДолговыеОбязательства КАК ДолговыеОбязательства
	|		ПО Мероприятие.Объект = ДолговыеОбязательства.Ссылка
	|ГДЕ
	|	(ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/McMurdo""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Ссылка ЕСТЬ NULL
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Casey""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Ссылка ЕСТЬ NULL
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""AET""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Ссылка ЕСТЬ NULL
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Asia/Chita""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Ссылка ЕСТЬ NULL
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Asia/Brunei""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Ссылка ЕСТЬ NULL
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""ACT""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Ссылка ЕСТЬ NULL
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Davis""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Ссылка ЕСТЬ NULL)
	|
	|УПОРЯДОЧИТЬ ПО
	|	Кредитор,
	|	КодДО";
	
	РезультатЗапроса = Запрос.Выполнить();
	
	Выборка = РезультатЗапроса.Выбрать();
	
	Пока Выборка.Следующий() Цикл
		Договор = Выборка.Ссылка.ПолучитьОбъект();
		стр = СписокАвтообзвона.Объекты.Добавить();
		стр.Объект = Договор.Ссылка;
		Должник = Договор.Должник.ПолучитьОбъект();
		Для каждого стр из Должник.Телефоны Цикл
			Если строка(стр.ВидТелефона) = "Мобильный" Тогда 
				стрТел = СписокАвтообзвона.СписокДляАО.Добавить();
				стрТел.Должник = Договор.Должник;
				стрТел.НомерТелефона = стр.Номер;
				// Фикс для нашей АТС
				стрТел.НомерТелефона = СтрСоединить(СтрРазделить(стр.Номер, "+( )"), "");
				// Конец
				стрТел.СтрокаАвтообзвона = Договор;
			КонецЕсли;
		КонецЦикла;
	КонецЦикла;
	
	//СписокАвтообзвона.Записать();
	ЗагрузитьНаСервере(СписокАвтообзвона);
	СписокАвтообзвона.Записать();
	
	//////////////////////////////////////////////////
	// Список по основным регионам (МСК-1...МСК+3) //
	////////////////////////////////////////////////
	
	СписокАвтообзвона = Справочники.СписокДляАвтообзвона.СоздатьЭлемент();
	СписокАвтообзвона.Наименование = "Основные регионы " + Формат(ТекущаяДата(), "ДФ=dd.MM.yyyy");
			
	Запрос = Новый Запрос;
	ГСЧ = Новый ГенераторСлучайныхЧисел();
    СлучайноеЧисло = "%"+ГСЧ.СлучайноеЧисло(0, 10)+"%";
	Запрос.УстановитьПараметр("ГСЧ", СлучайноеЧисло);
	Запрос.Текст = 
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ДолговыеОбязательства.Ссылка КАК Ссылка,
	|	ДолговыеОбязательства.Кредитор КАК Кредитор,
	|	ДолговыеОбязательства.КодДО КАК КодДО
	|ИЗ
	|	Задача.Мероприятие КАК Мероприятие
	|		ПРАВОЕ СОЕДИНЕНИЕ Справочник.ДолговыеОбязательства КАК ДолговыеОбязательства
	|		ПО Мероприятие.Объект = ДолговыеОбязательства.Ссылка
	|ГДЕ
	|	(ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Vostok""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Ссылка ЕСТЬ NULL
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Mawson""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Ссылка ЕСТЬ NULL
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Asia/Baku""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Ссылка ЕСТЬ NULL
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Syowa""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Ссылка ЕСТЬ NULL
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""EET""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Ссылка ЕСТЬ NULL)
	|
	|УПОРЯДОЧИТЬ ПО
	|	Кредитор,
	|	КодДО";
	
	РезультатЗапроса = Запрос.Выполнить();
	
	Выборка = РезультатЗапроса.Выбрать();
	
	Пока Выборка.Следующий() Цикл
		Договор = Выборка.Ссылка.ПолучитьОбъект();
		стр = СписокАвтообзвона.Объекты.Добавить();
		стр.Объект = Договор.Ссылка;
		Должник = Договор.Должник.ПолучитьОбъект();
		Для каждого стр из Должник.Телефоны Цикл
			Если строка(стр.ВидТелефона) = "Мобильный" Тогда 
				стрТел = СписокАвтообзвона.СписокДляАО.Добавить();
				стрТел.Должник = Договор.Должник;
				стрТел.НомерТелефона = стр.Номер;
				// Фикс для нашей АТС
				стрТел.НомерТелефона = СтрСоединить(СтрРазделить(стр.Номер, "+( )"), "");
				// Конец
				стрТел.СтрокаАвтообзвона = Договор;
			КонецЕсли;
		КонецЦикла;
	КонецЦикла;
	
	//СписокАвтообзвона.Записать();
	ЗагрузитьНаСервере(СписокАвтообзвона);
	СписокАвтообзвона.Записать();
	
	/////////////////////////////////////////////////
	// Список по новым реестрам (дальние регионы) //
	///////////////////////////////////////////////
	
	СписокАвтообзвона = Справочники.СписокДляАвтообзвона.СоздатьЭлемент();
	СписокАвтообзвона.Наименование = "Новые (дальние регионы) " + Формат(ТекущаяДата(), "ДФ=dd.MM.yyyy");
		
    Запрос = Новый Запрос;
	ГСЧ = Новый ГенераторСлучайныхЧисел();
    СлучайноеЧисло = "%"+ГСЧ.СлучайноеЧисло(0, 10)+"%";
	Запрос.УстановитьПараметр("ГСЧ", СлучайноеЧисло);
	Запрос.Текст = 
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ДолговыеОбязательства.Ссылка КАК Ссылка,
	|	ДолговыеОбязательства.Кредитор КАК Кредитор,
	|	ДолговыеОбязательства.КодДО КАК КодДО
	|ИЗ
	|	Задача.Мероприятие КАК Мероприятие
	|		ПРАВОЕ СОЕДИНЕНИЕ Справочник.ДолговыеОбязательства КАК ДолговыеОбязательства
	|		ПО Мероприятие.Объект = ДолговыеОбязательства.Ссылка
	|ГДЕ
	|	(ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/McMurdo""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Ссылка ЕСТЬ NULL
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Casey""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Ссылка ЕСТЬ NULL
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""AET""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Ссылка ЕСТЬ NULL
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Asia/Chita""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Ссылка ЕСТЬ NULL
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Asia/Brunei""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Ссылка ЕСТЬ NULL
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""ACT""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Ссылка ЕСТЬ NULL
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Davis""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Ссылка ЕСТЬ NULL)
	|
	|УПОРЯДОЧИТЬ ПО
	|	Кредитор,
	|	КодДО";
	
	РезультатЗапроса = Запрос.Выполнить();
	
	Выборка = РезультатЗапроса.Выбрать();
	
	Пока Выборка.Следующий() Цикл
		Договор = Выборка.Ссылка.ПолучитьОбъект();
		стр = СписокАвтообзвона.Объекты.Добавить();
		стр.Объект = Договор.Ссылка;
		Должник = Договор.Должник.ПолучитьОбъект();
		Для каждого стр из Должник.Телефоны Цикл
			Если строка(стр.ВидТелефона) = "Мобильный" Тогда 
				стрТел = СписокАвтообзвона.СписокДляАО.Добавить();
				стрТел.Должник = Договор.Должник;
				стрТел.НомерТелефона = стр.Номер;
				// Фикс для нашей АТС
				стрТел.НомерТелефона = СтрСоединить(СтрРазделить(стр.Номер, "+( )"), "");
				// Конец
				стрТел.СтрокаАвтообзвона = Договор;
			КонецЕсли;
		КонецЦикла;
	КонецЦикла;
	
	//СписокАвтообзвона.Записать();
	ЗагрузитьНаСервере(СписокАвтообзвона);
	СписокАвтообзвона.Записать();
	
	//////////////////////////////////////////
	// Список по новым реестрам (основной) //
	////////////////////////////////////////
	
	СписокАвтообзвона = Справочники.СписокДляАвтообзвона.СоздатьЭлемент();
	СписокАвтообзвона.Наименование = "Новые (основные регионы) " + Формат(ТекущаяДата(), "ДФ=dd.MM.yyyy");
		
    Запрос = Новый Запрос;
	ГСЧ = Новый ГенераторСлучайныхЧисел();
    СлучайноеЧисло = "%"+ГСЧ.СлучайноеЧисло(0, 10)+"%";
	Запрос.УстановитьПараметр("ГСЧ", СлучайноеЧисло);
	Запрос.Текст = 
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ДолговыеОбязательства.Ссылка КАК Ссылка,
	|	ДолговыеОбязательства.Кредитор КАК Кредитор,
	|	ДолговыеОбязательства.КодДО КАК КодДО
	|ИЗ
	|	Задача.Мероприятие КАК Мероприятие
	|		ПРАВОЕ СОЕДИНЕНИЕ Справочник.ДолговыеОбязательства КАК ДолговыеОбязательства
	|		ПО Мероприятие.Объект = ДолговыеОбязательства.Ссылка
	|ГДЕ
	|	(ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Vostok""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Ссылка ЕСТЬ NULL
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Mawson""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Ссылка ЕСТЬ NULL
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Asia/Baku""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Ссылка ЕСТЬ NULL
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Syowa""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Ссылка ЕСТЬ NULL
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""EET""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Ссылка ЕСТЬ NULL)
	|
	|УПОРЯДОЧИТЬ ПО
	|	Кредитор,
	|	КодДО";
	
	РезультатЗапроса = Запрос.Выполнить();
	
	Выборка = РезультатЗапроса.Выбрать();
	
	Пока Выборка.Следующий() Цикл
		Договор = Выборка.Ссылка.ПолучитьОбъект();
		стр = СписокАвтообзвона.Объекты.Добавить();
		стр.Объект = Договор.Ссылка;
		Должник = Договор.Должник.ПолучитьОбъект();
		Для каждого стр из Должник.Телефоны Цикл
			Если строка(стр.ВидТелефона) = "Мобильный" Тогда 
				стрТел = СписокАвтообзвона.СписокДляАО.Добавить();
				стрТел.Должник = Договор.Должник;
				стрТел.НомерТелефона = стр.Номер;
				// Фикс для нашей АТС
				стрТел.НомерТелефона = СтрСоединить(СтрРазделить(стр.Номер, "+( )"), "");
				// Конец
				стрТел.СтрокаАвтообзвона = Договор;
			КонецЕсли;
		КонецЦикла;
	КонецЦикла;
	
	//СписокАвтообзвона.Записать();
	ЗагрузитьНаСервере(СписокАвтообзвона);
	СписокАвтообзвона.Записать();
	
	/////////////////////////////////////////////////////////
	// Список по просроченным обещаниям (дальние регионы) //
	///////////////////////////////////////////////////////
	
	СписокАвтообзвона = Справочники.СписокДляАвтообзвона.СоздатьЭлемент();
	СписокАвтообзвона.Наименование = "Просроченные (дальние регионы) " + Формат(ТекущаяДата(), "ДФ=dd.MM.yyyy");
	
	Запрос = Новый Запрос;
    ГСЧ = Новый ГенераторСлучайныхЧисел();
    СлучайноеЧисло = "%"+ГСЧ.СлучайноеЧисло(0, 10)+"%";
	Запрос.УстановитьПараметр("ГСЧ", СлучайноеЧисло);
	Запрос.Текст = 
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ДолговыеОбязательства.Ссылка КАК Ссылка,
	|	ДолговыеОбязательства.Кредитор КАК Кредитор,
	|	ДолговыеОбязательства.КодДО КАК КодДО
	|ИЗ
	|	Задача.Мероприятие КАК Мероприятие
	|		ПРАВОЕ СОЕДИНЕНИЕ Справочник.ДолговыеОбязательства КАК ДолговыеОбязательства
	|		ПО Мероприятие.Объект = ДолговыеОбязательства.Ссылка
	|ГДЕ
	|	(ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/McMurdo""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Casey""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""AET""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Asia/Chita""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Asia/Brunei""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""ACT""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Davis""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%"")
	|
	|УПОРЯДОЧИТЬ ПО
	|	Кредитор,
	|	КодДО";
	
	РезультатЗапроса = Запрос.Выполнить();
	
	Выборка = РезультатЗапроса.Выбрать();
	
	Пока Выборка.Следующий() Цикл
		Договор = Выборка.Ссылка.ПолучитьОбъект();
		Если НЕ КонтрольСобытий.РезультативныеЗвонки(Договор.Должник) Тогда
			стр = СписокАвтообзвона.Объекты.Добавить();
			стр.Объект = Договор.Ссылка;
			Должник = Договор.Должник.ПолучитьОбъект();
			Для каждого стр из Должник.Телефоны Цикл
				Если строка(стр.ВидТелефона) = "Мобильный" Тогда 
					стрТел = СписокАвтообзвона.СписокДляАО.Добавить();
					стрТел.Должник = Договор.Должник;
					стрТел.НомерТелефона = стр.Номер;
					// Фикс для нашей АТС
					стрТел.НомерТелефона = СтрСоединить(СтрРазделить(стр.Номер, "+( )"), "");
					// Конец
					стрТел.СтрокаАвтообзвона = Договор;
				КонецЕсли;
			КонецЦикла;
		КонецЕсли;
	КонецЦикла;
	
	//СписокАвтообзвона.Записать();
	ЗагрузитьНаСервере(СписокАвтообзвона);
	СписокАвтообзвона.Записать();
	
	//////////////////////////////////////////////////
	// Список по просроченным обещаниям (основной) //
	////////////////////////////////////////////////
	
	СписокАвтообзвона = Справочники.СписокДляАвтообзвона.СоздатьЭлемент();
	СписокАвтообзвона.Наименование = "Просроченные (основные регионы) " + Формат(ТекущаяДата(), "ДФ=dd.MM.yyyy");
	
	Запрос = Новый Запрос;
	ГСЧ = Новый ГенераторСлучайныхЧисел();
    СлучайноеЧисло = "%"+ГСЧ.СлучайноеЧисло(0, 10)+"%";
	Запрос.УстановитьПараметр("ГСЧ", СлучайноеЧисло);
	Запрос.Текст = 
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ДолговыеОбязательства.Ссылка КАК Ссылка,
	|	ДолговыеОбязательства.Кредитор КАК Кредитор,
	|	ДолговыеОбязательства.КодДО КАК КодДО
	|ИЗ
	|	Задача.Мероприятие КАК Мероприятие
	|		ПРАВОЕ СОЕДИНЕНИЕ Справочник.ДолговыеОбязательства КАК ДолговыеОбязательства
	|		ПО Мероприятие.Объект = ДолговыеОбязательства.Ссылка
	|ГДЕ
	|	(ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Vostok""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Mawson""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Asia/Baku""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Syowa""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""EET""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%"")
	|
	|УПОРЯДОЧИТЬ ПО
	|	Кредитор,
	|	КодДО";
	
	РезультатЗапроса = Запрос.Выполнить();
	
	Выборка = РезультатЗапроса.Выбрать();
	
	Пока Выборка.Следующий() Цикл
		Договор = Выборка.Ссылка.ПолучитьОбъект();
		Если НЕ КонтрольСобытий.РезультативныеЗвонки(Договор.Должник) Тогда
			стр = СписокАвтообзвона.Объекты.Добавить();
			стр.Объект = Договор.Ссылка;
			Должник = Договор.Должник.ПолучитьОбъект();
			Для каждого стр из Должник.Телефоны Цикл
				Если строка(стр.ВидТелефона) = "Мобильный" Тогда 
					стрТел = СписокАвтообзвона.СписокДляАО.Добавить();
					стрТел.Должник = Договор.Должник;
					стрТел.НомерТелефона = стр.Номер;
					// Фикс для нашей АТС
					стрТел.НомерТелефона = СтрСоединить(СтрРазделить(стр.Номер, "+( )"), "");
					// Конец
					стрТел.СтрокаАвтообзвона = Договор;
				КонецЕсли;
			КонецЦикла;
		КонецЕсли;
	КонецЦикла;
	
	//СписокАвтообзвона.Записать();
	ЗагрузитьНаСервере(СписокАвтообзвона);
	СписокАвтообзвона.Записать();	
	
	/////////////////////////////////////////////
	// Список по отказникам (дальние регионы) //
	///////////////////////////////////////////
	
	СписокАвтообзвона = Справочники.СписокДляАвтообзвона.СоздатьЭлемент();
	СписокАвтообзвона.Наименование = "Отказники (дальние регионы) " + Формат(ТекущаяДата(), "ДФ=dd.MM.yyyy");
	
	Запрос = Новый Запрос;
	ГСЧ = Новый ГенераторСлучайныхЧисел();
    СлучайноеЧисло = "%"+ГСЧ.СлучайноеЧисло(0, 10)+"%";
	Запрос.УстановитьПараметр("ГСЧ", СлучайноеЧисло);
	Запрос.Текст = 
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ДолговыеОбязательства.Ссылка КАК Ссылка,
	|	ДолговыеОбязательства.Кредитор КАК Кредитор,
	|	ДолговыеОбязательства.КодДО КАК КодДО
	|ИЗ
	|	Задача.Мероприятие КАК Мероприятие
	|		ПРАВОЕ СОЕДИНЕНИЕ Справочник.ДолговыеОбязательства КАК ДолговыеОбязательства
	|		ПО Мероприятие.Объект = ДолговыеОбязательства.Ссылка
	|ГДЕ
	|	(ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/McMurdo""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Casey""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""AET""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Asia/Chita""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Asia/Brunei""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""ACT""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Davis""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|			ИЛИ (ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|					И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/McMurdo""
	|					И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|					И Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|					И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Casey""
	|					И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|					И Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|					И ДолговыеОбязательства.Должник.ЧасовойПояс = ""AET""
	|					И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|					И Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|					И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Asia/Chita""
	|					И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|					И Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|					И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Asia/Brunei""
	|					И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|					И Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|					И ДолговыеОбязательства.Должник.ЧасовойПояс = ""ACT""
	|					И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|					И Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|					И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Davis""
	|					И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|					И Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""))
	|
	|УПОРЯДОЧИТЬ ПО
	|	Кредитор,
	|	КодДО";
	
	РезультатЗапроса = Запрос.Выполнить();
	
	Выборка = РезультатЗапроса.Выбрать();
	
	Пока Выборка.Следующий() Цикл
		Договор = Выборка.Ссылка.ПолучитьОбъект();
		Если НЕ КонтрольСобытий.РезультативныеЗвонки(Договор.Должник) Тогда
			стр = СписокАвтообзвона.Объекты.Добавить();
			стр.Объект = Договор.Ссылка;
			Должник = Договор.Должник.ПолучитьОбъект();
			Для каждого стр из Должник.Телефоны Цикл
				Если строка(стр.ВидТелефона) = "Мобильный" Тогда 
					стрТел = СписокАвтообзвона.СписокДляАО.Добавить();
					стрТел.Должник = Договор.Должник;
					стрТел.НомерТелефона = стр.Номер;
					// Фикс для нашей АТС
					стрТел.НомерТелефона = СтрСоединить(СтрРазделить(стр.Номер, "+( )"), "");
					// Конец
					стрТел.СтрокаАвтообзвона = Договор;
				КонецЕсли;
			КонецЦикла;
		КонецЕсли;
	КонецЦикла;
	
	//СписокАвтообзвона.Записать();
	ЗагрузитьНаСервере(СписокАвтообзвона);
	СписокАвтообзвона.Записать();
	
	//////////////////////////////////////
	// Список по отказникам (основной) //
	////////////////////////////////////
	
	СписокАвтообзвона = Справочники.СписокДляАвтообзвона.СоздатьЭлемент();
	СписокАвтообзвона.Наименование = "Отказники (основные регионы) " + Формат(ТекущаяДата(), "ДФ=dd.MM.yyyy");
	
	Запрос = Новый Запрос;
	ГСЧ = Новый ГенераторСлучайныхЧисел();
    СлучайноеЧисло = "%"+ГСЧ.СлучайноеЧисло(0, 10)+"%";
	Запрос.УстановитьПараметр("ГСЧ", СлучайноеЧисло);
	Запрос.Текст = 
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ДолговыеОбязательства.Ссылка КАК Ссылка,
	|	ДолговыеОбязательства.Кредитор КАК Кредитор,
	|	ДолговыеОбязательства.КодДО КАК КодДО
	|ИЗ
	|	Задача.Мероприятие КАК Мероприятие
	|		ПРАВОЕ СОЕДИНЕНИЕ Справочник.ДолговыеОбязательства КАК ДолговыеОбязательства
	|		ПО Мероприятие.Объект = ДолговыеОбязательства.Ссылка
	|ГДЕ
	|	(ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Vostok""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Mawson""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Asia/Baku""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Syowa""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""EET""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|			ИЛИ (ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|					И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Vostok""
	|					И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|					И Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|					И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Mawson""
	|					И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|					И Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|					И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Asia/Baku""
	|					И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|					И Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|					И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Syowa""
	|					И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|					И Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|					И ДолговыеОбязательства.Должник.ЧасовойПояс = ""EET""
	|					И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|					И Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""))
	|
	|УПОРЯДОЧИТЬ ПО
	|	Кредитор,
	|	КодДО";
	
	РезультатЗапроса = Запрос.Выполнить();
	
	Выборка = РезультатЗапроса.Выбрать();
	
	Пока Выборка.Следующий() Цикл
		Договор = Выборка.Ссылка.ПолучитьОбъект();
		Если НЕ КонтрольСобытий.РезультативныеЗвонки(Договор.Должник) Тогда
			стр = СписокАвтообзвона.Объекты.Добавить();
			стр.Объект = Договор.Ссылка;
			Должник = Договор.Должник.ПолучитьОбъект();
			Для каждого стр из Должник.Телефоны Цикл
				Если строка(стр.ВидТелефона) = "Мобильный" Тогда 
					стрТел = СписокАвтообзвона.СписокДляАО.Добавить();
					стрТел.Должник = Договор.Должник;
					стрТел.НомерТелефона = стр.Номер;
					// Фикс для нашей АТС
					стрТел.НомерТелефона = СтрСоединить(СтрРазделить(стр.Номер, "+( )"), "");
					// Конец
					стрТел.СтрокаАвтообзвона = Договор;
				КонецЕсли;
			КонецЦикла;
		КонецЕсли;
	КонецЦикла;
	
	//СписокАвтообзвона.Записать();
	ЗагрузитьНаСервере(СписокАвтообзвона);
	СписокАвтообзвона.Записать();
	
		///////////////////////////////////////////
	// Список по неконтактным (дальние регионы) //
	/////////////////////////////////////////////
	
	СписокАвтообзвона = Справочники.СписокДляАвтообзвона.СоздатьЭлемент();
	СписокАвтообзвона.Наименование = "Неконтактные (дальние регионы) " + Формат(ТекущаяДата(), "ДФ=dd.MM.yyyy");
	
	Запрос = Новый Запрос;
	ГСЧ = Новый ГенераторСлучайныхЧисел();
    СлучайноеЧисло = "%"+ГСЧ.СлучайноеЧисло(0, 10)+"%";
	Запрос.УстановитьПараметр("ГСЧ", СлучайноеЧисло);
	Запрос.Текст = 
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ДолговыеОбязательства.Ссылка КАК Ссылка,
	|	ДолговыеОбязательства.Кредитор КАК Кредитор,
	|	ДолговыеОбязательства.КодДО КАК КодДО
	|ИЗ
	|	Задача.Мероприятие КАК Мероприятие
	|		ПРАВОЕ СОЕДИНЕНИЕ Справочник.ДолговыеОбязательства КАК ДолговыеОбязательства
	|		ПО Мероприятие.Объект = ДолговыеОбязательства.Ссылка
	|ГДЕ
	|	(ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/McMurdo""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ИЗБЕГАЕТ%""
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Casey""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ИЗБЕГАЕТ%""
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""AET""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ИЗБЕГАЕТ%""
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Asia/Chita""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ИЗБЕГАЕТ%""
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Asia/Brunei""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ИЗБЕГАЕТ%""
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""ACT""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ИЗБЕГАЕТ%""
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Davis""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ИЗБЕГАЕТ%""
	|			ИЛИ (ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|					И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/McMurdo""
	|					И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|					И Мероприятие.Результат.Наименование ПОДОБНО ""%ИЗБЕГАЕТ%""
	|				ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|					И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Casey""
	|					И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|					И Мероприятие.Результат.Наименование ПОДОБНО ""%ИЗБЕГАЕТ%""
	|				ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|					И ДолговыеОбязательства.Должник.ЧасовойПояс = ""AET""
	|					И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|					И Мероприятие.Результат.Наименование ПОДОБНО ""%ИЗБЕГАЕТ%""
	|				ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|					И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Asia/Chita""
	|					И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|					И Мероприятие.Результат.Наименование ПОДОБНО ""%ИЗБЕГАЕТ%""
	|				ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|					И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Asia/Brunei""
	|					И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|					И Мероприятие.Результат.Наименование ПОДОБНО ""%ИЗБЕГАЕТ%""
	|				ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|					И ДолговыеОбязательства.Должник.ЧасовойПояс = ""ACT""
	|					И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|					И Мероприятие.Результат.Наименование ПОДОБНО ""%ИЗБЕГАЕТ%""
	|				ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|					И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Davis""
	|					И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|					И Мероприятие.Результат.Наименование ПОДОБНО ""%ИЗБЕГАЕТ%""))
	|
	|УПОРЯДОЧИТЬ ПО
	|	Кредитор,
	|	КодДО";
	
	РезультатЗапроса = Запрос.Выполнить();
	
	Выборка = РезультатЗапроса.Выбрать();
	
	Пока Выборка.Следующий() Цикл
		Договор = Выборка.Ссылка.ПолучитьОбъект();
		Если НЕ КонтрольСобытий.РезультативныеЗвонки(Договор.Должник) Тогда
			стр = СписокАвтообзвона.Объекты.Добавить();
			стр.Объект = Договор.Ссылка;
			Должник = Договор.Должник.ПолучитьОбъект();
			Для каждого стр из Должник.Телефоны Цикл
				Если строка(стр.ВидТелефона) = "Мобильный" Тогда 
					стрТел = СписокАвтообзвона.СписокДляАО.Добавить();
					стрТел.Должник = Договор.Должник;
					стрТел.НомерТелефона = стр.Номер;
					// Фикс для нашей АТС
					стрТел.НомерТелефона = СтрСоединить(СтрРазделить(стр.Номер, "+( )"), "");
					// Конец
					стрТел.СтрокаАвтообзвона = Договор;
				КонецЕсли;
			КонецЦикла;
		КонецЕсли;
	КонецЦикла;
	
	//СписокАвтообзвона.Записать();
	ЗагрузитьНаСервере(СписокАвтообзвона);
	СписокАвтообзвона.Записать();
	
	////////////////////////////////////////
	// Список по неконтактным (основной) //
	//////////////////////////////////////
	
	СписокАвтообзвона = Справочники.СписокДляАвтообзвона.СоздатьЭлемент();
	СписокАвтообзвона.Наименование = "Неконтактные (основные регионы) " + Формат(ТекущаяДата(), "ДФ=dd.MM.yyyy");
	
	Запрос = Новый Запрос;
	ГСЧ = Новый ГенераторСлучайныхЧисел();
    СлучайноеЧисло = "%"+ГСЧ.СлучайноеЧисло(0, 10)+"%";
	Запрос.УстановитьПараметр("ГСЧ", СлучайноеЧисло);
	Запрос.Текст = 
	"ВЫБРАТЬ РАЗЛИЧНЫЕ
	|	ДолговыеОбязательства.Ссылка КАК Ссылка,
	|	ДолговыеОбязательства.Кредитор КАК Кредитор,
	|	ДолговыеОбязательства.КодДО КАК КодДО
	|ИЗ
	|	Задача.Мероприятие КАК Мероприятие
	|		ПРАВОЕ СОЕДИНЕНИЕ Справочник.ДолговыеОбязательства КАК ДолговыеОбязательства
	|		ПО Мероприятие.Объект = ДолговыеОбязательства.Ссылка
	|ГДЕ
	|	(ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Vostok""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ИЗБЕГАЕТ%""
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Mawson""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ИЗБЕГАЕТ%""
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Asia/Baku""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ИЗБЕГАЕТ%""
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Syowa""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ИЗБЕГАЕТ%""
	|			ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""В работе""
	|				И ДолговыеОбязательства.Должник.ЧасовойПояс = ""EET""
	|				И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|				И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|				И Мероприятие.Результат.Наименование ПОДОБНО ""%ИЗБЕГАЕТ%""
	|			ИЛИ (ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|					И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Vostok""
	|					И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|					И Мероприятие.Результат.Наименование ПОДОБНО ""%ИЗБЕГАЕТ%""
	|				ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|					И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Mawson""
	|					И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|					И Мероприятие.Результат.Наименование ПОДОБНО ""%ИЗБЕГАЕТ%""
	|				ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|					И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Asia/Baku""
	|					И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|					И Мероприятие.Результат.Наименование ПОДОБНО ""%ИЗБЕГАЕТ%""
	|				ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|					И ДолговыеОбязательства.Должник.ЧасовойПояс = ""Antarctica/Syowa""
	|					И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|					И Мероприятие.Результат.Наименование ПОДОБНО ""%ИЗБЕГАЕТ%""
	|				ИЛИ ДолговыеОбязательства.ДополнительныеРеквизиты.Значение.Наименование = ""Новые""
	|					И ДолговыеОбязательства.Должник.ЧасовойПояс = ""EET""
	|					И ДолговыеОбязательства.КодДО ПОДОБНО &ГСЧ
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОТКАЗ%""
	|					И НЕ Мероприятие.Результат.Наименование ПОДОБНО ""%ОБЕЩАНИЕ%""
	|					И Мероприятие.Результат.Наименование ПОДОБНО ""%ИЗБЕГАЕТ%""))
	|
	|УПОРЯДОЧИТЬ ПО
	|	Кредитор,
	|	КодДО";
	
	РезультатЗапроса = Запрос.Выполнить();
	
	Выборка = РезультатЗапроса.Выбрать();
	
	Пока Выборка.Следующий() Цикл
		Договор = Выборка.Ссылка.ПолучитьОбъект();
		Если НЕ КонтрольСобытий.РезультативныеЗвонки(Договор.Должник) Тогда
			стр = СписокАвтообзвона.Объекты.Добавить();
			стр.Объект = Договор.Ссылка;
			Должник = Договор.Должник.ПолучитьОбъект();
			Для каждого стр из Должник.Телефоны Цикл
				Если строка(стр.ВидТелефона) = "Мобильный" Тогда 
					стрТел = СписокАвтообзвона.СписокДляАО.Добавить();
					стрТел.Должник = Договор.Должник;
					стрТел.НомерТелефона = стр.Номер;
					// Фикс для нашей АТС
					стрТел.НомерТелефона = СтрСоединить(СтрРазделить(стр.Номер, "+( )"), "");
					// Конец
					стрТел.СтрокаАвтообзвона = Договор;
				КонецЕсли;
			КонецЦикла;
		КонецЕсли;
	КонецЦикла;
	
	//СписокАвтообзвона.Записать();
	ЗагрузитьНаСервере(СписокАвтообзвона);
	СписокАвтообзвона.Записать();
	
КонецПроцедуры
