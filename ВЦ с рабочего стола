&НаСервере
Процедура НаписатьВВЦНаСервере()
	// Получим непредопределенное значение с сервера
 	ЭтаФорма.ТипВЦ = Справочники.ТипыМероприятий.НайтиПоНаименованию("WhatsApp");
	ЭтаФорма.РезультатОтправлено = Справочники.РезультатыМероприятий.НайтиПоНаименованию("Отправлено");
КонецПроцедуры

&НаКлиенте
Процедура НаписатьВВЦ(Команда)
	НаписатьВВЦНаСервере();
	// Выполняем обычную клиентскую процедуру
	Если Элементы.СписокДО.ТекущиеДанные <> Неопределено Тогда
		К = ПолучитьОбъектЗвонка(Элементы.СписокДО.ТекущиеДанные.Объект);
		Если ТипЗнч(К) = Тип("СправочникСсылка.ДолговыеОбязательства") Тогда
			Контрагент = ПолучитьДолжника(К);
		Иначе
			Контрагент = К;
		КонецЕсли;
	    НоваяЗадача = ПолучитьФорму("Задача.Мероприятие.Форма.ФормаМероприятия", Новый Структура("Объект", К));
		НоваяЗадача.Объект.Объект = К;
		НоваяЗадача.Объект.ТипМероприятия = ТипВЦ;
		НоваяЗадача.Объект.Результат = РезультатОтправлено 
		// НоваяЗадача.Объект.Контакт = РезультатНомер;
		НоваяЗадача.КонтрагентКЛ = Контрагент;
		НоваяЗадача.Открыть();
	КонецЕсли;	
КонецПроцедуры
