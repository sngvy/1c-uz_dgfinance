&НаСервере
Процедура ЗакрепитьНаСервере()
	// Вставить содержимое обработчика.
	ОбъектВх = ЭтаФорма.ДолговоеОбязательство;
    СпрКат = Справочники.тсЗначенияСвойствОбъектов;
    ЗначКат = СпрКат.НайтиПоНаименованию("СТОП");
    КодКат = "0181";
    ОбъектыСервер.ЗаписатьЗначениеСвойства(ОбъектВх.Ссылка, КодКат, ЗначКат); 
    СпрПрич = Справочники.тсЗначенияСвойствОбъектов;
    ЗначПрич = СпрКат.НайтиПоНаименованию("Ручной обзвон");
    КодПрич = "0182";
    ОбъектыСервер.ЗаписатьЗначениеСвойства(ОбъектВх.Ссылка, КодПрич, ЗначПрич); 
    КодПольз = "0183";
    ЗначПольз = ПараметрыСеанса.ТекущийПользователь;
    ОбъектыСервер.ЗаписатьЗначениеСвойства(ОбъектВх.Ссылка, КодПольз, ЗначПольз); 
КонецПроцедуры

&НаКлиенте
Процедура Закрепить(Команда)
	ЗакрепитьНаСервере();
	Сообщить("Должник закреплен!");
КонецПроцедуры

&НаСервере
Процедура ОткрепитьНаСервере()
	// Вставить содержимое обработчика.
	ОбъектВх = ЭтаФорма.ДолговоеОбязательство;
    СпрКат = Справочники.тсЗначенияСвойствОбъектов;
    ЗначКат = СпрКат.НайтиПоНаименованию("В работе");
    КодКат = "0181";
    ОбъектыСервер.ЗаписатьЗначениеСвойства(ОбъектВх.Ссылка, КодКат, ЗначКат); 
    СпрПрич = Справочники.тсЗначенияСвойствОбъектов;
    ЗначПрич = "";
    КодПрич = "0182";
    ОбъектыСервер.ЗаписатьЗначениеСвойства(ОбъектВх.Ссылка, КодПрич, ЗначПрич); 
    КодПольз = "0183";
    ЗначПольз = "";
    ОбъектыСервер.ЗаписатьЗначениеСвойства(ОбъектВх.Ссылка, КодПольз, ЗначПольз); 
КонецПроцедуры

&НаКлиенте
Процедура Открепить(Команда)
	ОткрепитьНаСервере();
	Сообщить("Должник откреплен!");
КонецПроцедуры
