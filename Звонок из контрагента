&НаКлиенте
Процедура ИсходящийЗвонок(Команда)
	Если Объект.Ссылка.Пустая() Тогда	
    	Сообщить("Сначала запишите объект!");		
	 	Возврат;
	КонецЕсли; 
		
	НоваяЗадача = ПолучитьФорму("Задача.Мероприятие.Форма.ФормаМероприятия", Новый Структура("Объект", Объект.Ссылка));
	НоваяЗадача.Объект.Объект = ЭтаФорма.Объект.Ссылка;
	НоваяЗадача.Объект.ТипМероприятия = ПредопределенноеЗначение("Справочник.ТипыМероприятий.ТелефонныйЗвонокИсходящий");
	// НоваяЗадача.Объект.Контакт = РезультатНомер;
	НоваяЗадача.КонтрагентКЛ = ЭтаФорма.Объект.Ссылка;
	НоваяЗадача.Открыть();
	ВидТелефонии = Бит_ТелефонияСерверПереопределяемый.ПолучитьВидТелефонии();
	НоваяЗадача.КлючУникальности = Новый УникальныйИдентификатор;
	Если ВидТелефонии = ПредопределенноеЗначение("Перечисление.ВидыТелефонии.БИТФон") Тогда
		Ф = ПолучитьФорму("Обработка.бит_БИТфон.форма",, );
		Ф.ФормаМероприятие = НоваяЗадача.КлючУникальности;
				// Проверить статус формы
		Если Ф.Открыта() = Ложь Тогда
			Предупреждение("БИТ.Phone не подключен!");
			Возврат;
			Если Ф.ИдетРазговор = Истина Тогда
				Предупреждение("На канале уже идет разговор!");
				Возврат;
			КонецЕсли;
        // Проверить статус оператора
		Если Ф.СтатусПодключен = Истина Тогда
            Ф.НомерЛиния1 = Элементы.Телефоны.ТекущиеДанные.Номер;
			Ф.НачатьРазговорКл(Неопределено);
			ПоказатьОповещениеПользователя("Исходящий звонок",,"Начат вызов на выбранный номер...",БиблиотекаКартинок.Информация32);
		Иначе
			Ф.кнПодключить(Неопределено);
			Ф.ОбработчикСобытияРегистрация("Успешно");
			Ф.НомерЛиния1 = Элементы.Телефоны.ТекущиеДанные.Номер;
			Ф.НачатьРазговорКл(Неопределено);
	        ПоказатьОповещениеПользователя("Исходящий звонок",,"Начат вызов на выбранный номер...",БиблиотекаКартинок.Информация32);
		КонецЕсли;
	КонецЕсли;
КонецПроцедуры
